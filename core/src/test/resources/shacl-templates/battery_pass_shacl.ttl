@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix bp: <http://example.org/battery-passport#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

# STRATEGY 2: OPTIMIZED FOR VOCABULARY_URI EXTRACTION
# Tutte le propriet√† usano lo stesso namespace per facilitare l'estrazione
# Alcune shape hanno targetClass, altre no (approccio misto)

# Ontology declaration
<http://example.org/battery-passport> a owl:Ontology ;
    owl:imports <http://example.org/battery-passport> .

# Main Battery Passport Shape
bp:BatteryPassportShape
    a sh:NodeShape ;
    sh:targetClass bp:BatteryPassport ;
    sh:property [
        sh:path bp:productIdentification ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:ProductIdentificationShape ;
    ] ;
    sh:property [
        sh:path bp:generalInformation ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:GeneralInformationShape ;
    ] ;
    sh:property [
        sh:path bp:performance ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:PerformanceShape ;
    ] ;
    sh:property [
        sh:path bp:sustainability ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:SustainabilityShape ;
    ] ;
    sh:property [
        sh:path bp:circularity ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:CircularityShape ;
    ] ;
    sh:property [
        sh:path bp:safety ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:SafetyShape ;
    ] ;
    sh:property [
        sh:path bp:dataSource ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:DataSourceShape ;
    ] ;
    sh:property [
        sh:path bp:composition ;
        sh:maxCount 1 ;
        sh:node bp:CompositionShape ;
    ] .

# Product Identification Shape - NO targetClass (nidificata)
bp:ProductIdentificationShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:batteryUID ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:description "Unique identifier for the battery" ;
    ] ;
    sh:property [
        sh:path bp:manufacturer ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:ManufacturerShape ;
    ] .

# Manufacturer Shape - NO targetClass (nidificata)
bp:ManufacturerShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:name ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] ;
    sh:property [
        sh:path bp:streetName ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] ;
    sh:property [
        sh:path bp:postalCode ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] ;
    sh:property [
        sh:path bp:cityName ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] ;
    sh:property [
        sh:path bp:countryCode ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] .

# General Information Shape - CON targetClass
bp:GeneralInformationShape
    a sh:NodeShape ;
    sh:targetClass bp:GeneralInformation ;
    sh:property [
        sh:path bp:batteryCategory ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:in ("LMT" "EV" "Industrial" "SLI") ;
        sh:description "LMT=Light Means of Transport, EV=Electric Vehicle, SLI=Starting Lighting Ignition" ;
    ] ;
    sh:property [
        sh:path bp:batteryWeight ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Total weight in kilograms" ;
    ] ;
    sh:property [
        sh:path bp:manufacturingDate ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:date ;
    ] ;
    sh:property [
        sh:path bp:batteryChemistry ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:description "Battery chemistry type (e.g., NMC, LFP, NCA)" ;
    ] .

# Performance Shape - CON targetClass
bp:PerformanceShape
    a sh:NodeShape ;
    sh:targetClass bp:Performance ;
    sh:property [
        sh:path bp:ratedCapacity ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Capacity in Ah" ;
    ] ;
    sh:property [
        sh:path bp:nominalVoltage ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Voltage in V" ;
    ] ;
    sh:property [
        sh:path bp:powerCapability ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Power in W" ;
    ] ;
    sh:property [
        sh:path bp:internalResistance ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:roundTripEfficiency ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] .

# Sustainability Shape - NO targetClass
bp:SustainabilityShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:carbonFootprint ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:CarbonFootprintShape ;
    ] ;
    sh:property [
        sh:path bp:criticalRawMaterials ;
        sh:maxCount 1 ;
        sh:node bp:CriticalRawMaterialsShape ;
    ] .

# Carbon Footprint Shape - NO targetClass
bp:CarbonFootprintShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:lifeCycleCarbon ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Total carbon footprint in kg CO2 eq" ;
    ] ;
    sh:property [
        sh:path bp:carbonFootprintPerformanceClass ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:in ("A" "B" "C" "D" "E") ;
    ] .

# Critical Raw Materials Shape - NO targetClass
bp:CriticalRawMaterialsShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:nickel ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:cobalt ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:lithium ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] .

# Circularity Shape - CON targetClass
bp:CircularityShape
    a sh:NodeShape ;
    sh:targetClass bp:Circularity ;
    sh:property [
        sh:path bp:recyclableContent ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:node bp:RecyclableContentShape ;
    ] ;
    sh:property [
        sh:path bp:dismantlingInstructions ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] ;
    sh:property [
        sh:path bp:spareParts ;
        sh:maxCount 1 ;
    ] .

# Recyclable Content Shape - NO targetClass
bp:RecyclableContentShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:cobalt ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Percentage of recycled cobalt" ;
    ] ;
    sh:property [
        sh:path bp:lithium ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Percentage of recycled lithium" ;
    ] ;
    sh:property [
        sh:path bp:nickel ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Percentage of recycled nickel" ;
    ] ;
    sh:property [
        sh:path bp:lead ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
        sh:description "Percentage of recycled lead" ;
    ] .

# Safety Shape - NO targetClass
bp:SafetyShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:safetyInstructions ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:description "Safety and handling instructions" ;
    ] ;
    sh:property [
        sh:path bp:thermalStability ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] .

# Data Source Shape - NO targetClass
bp:DataSourceShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:lastUpdate ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:dateTime ;
    ] ;
    sh:property [
        sh:path bp:dataProvider ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
    ] .

# Composition Shape - NO targetClass
bp:CompositionShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:cathodeActiveMaterial ;
        sh:maxCount 1 ;
        sh:node bp:CathodeActiveMaterialShape ;
    ] .

# Cathode Active Material Shape - NO targetClass
bp:CathodeActiveMaterialShape
    a sh:NodeShape ;
    sh:property [
        sh:path bp:nickelContent ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:manganeseContent ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:cobaltContent ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:ironContent ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:phosphateContent ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] ;
    sh:property [
        sh:path bp:aluminumContent ;
        sh:maxCount 1 ;
        sh:datatype xsd:double ;
    ] .
